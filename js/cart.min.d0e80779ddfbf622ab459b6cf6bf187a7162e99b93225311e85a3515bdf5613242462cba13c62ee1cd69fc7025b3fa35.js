async function getCatalog(){return await(await fetch("/catalog.json")).json()}function getCart(){return JSON.parse(localStorage.getItem("cart"))||{}}function setCart(e){localStorage.setItem("cart",JSON.stringify(e))}async function addToCart(e){var n=await getCatalog(),t=getCart();e in n&&(t[e]?t[e].quantity+=1:t[e]={quantity:1},setCart(t))}function clearCart(){localStorage.removeItem("cart")}function changeQuantity(e,t){var n=getCart();console.log(e),n[e]&&n[e].quantity+t>0&&(n[e].quantity+=t),setCart(n)}async function displayCart(){var e,n,s,o,i,a,c,l,t=await getCatalog(),r=document.getElementById("cart-items");if(r!=null){r.innerHTML="",c=0,l=0,i=JSON.parse(localStorage.getItem("cart"))||{};for(e in i)Object.hasOwn(i,e)&&e in t&&(s=i[e],n=document.createElement("div"),n.classList.add("cart-item"),n.innerHTML="<strong>"+t[e].name+'</strong><br/> <p class="cart-action" id="quantity-minus" data-id="'+e+'">-</p> '+s.quantity+' <p class="cart-action" id="quantity-plus" data-id="'+e+'">+</p>  x ',o=t[e].price,"discountedPrice"in t[e]&&(o=t[e].discountedPrice,n.innerHTML+='<span class="strikethrough">'+t[e].price+"Ft</span> "),n.innerHTML+=o+"Ft = <strong>"+s.quantity*o+"Ft</strong>",r.appendChild(n),c+=s.quantity*o,l+=s.quantity*t[e].price);a=document.getElementById("final-price"),a.innerHTML=c+"Ft",a=document.getElementById("real-price"),a.innerHTML=l+"Ft",document.querySelectorAll("#quantity-minus").forEach(function(e){e.addEventListener("click",function(){changeQuantity(e.getAttribute("data-id"),-1),displayCart()})}),document.querySelectorAll("#quantity-plus").forEach(function(e){e.addEventListener("click",function(){changeQuantity(e.getAttribute("data-id"),+1),displayCart()})})}else console.log("displayCart: Can't display cart, no container.")}window.addEventListener("DOMContentLoaded",displayCart),window.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("payment-form");e?e.addEventListener("submit",clearCart):console.log("on DOMContentLoaded: no payment-form, probably not on checkout."),document.querySelectorAll(".buy").forEach(e=>{e.addEventListener("click",function(){addToCart(e.dataset.id)})})})